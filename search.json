[
  {
    "objectID": "Sampling Practicals.html",
    "href": "Sampling Practicals.html",
    "title": "Sampling Practical Assignments",
    "section": "",
    "text": "Q.(1) The sugarcane production and cultivation of Indian states are presented in excel sheet Sugarcane Production cultivation. Draw a random sample using SRSWOR of size 10 and estimate the average amount of sugarcane production using the regression method of estimation and obtain the 95% confidence interval for the population mean.\n\n\nCode\nlibrary(dplyr)\nlibrary(tidyr)\nset.seed(123)\nsugarcane_data &lt;- readxl::read_xlsx(\n  \"data/Sugarcane_Production_Cultivation.xlsx\")\n\n\nX &lt;- sugarcane_data$`CultivatedArea (in lakh acres)`\nY &lt;- sugarcane_data$`Production (in lakh tonnes)`\nN &lt;- length(Y)\nn &lt;- 10\ns &lt;- sample(1:N,n,replace = F)\nx1 &lt;- X[s]\nx1\n\n\n [1] 1.83 0.17 0.05 2.43 0.98 0.30 1.14 9.02 1.84 0.30\n\n\nCode\ny1 &lt;- Y[s]\ny1\n\n\n [1] 165.62  12.94   4.04 165.11  54.30  11.15  87.29 726.37 122.34  12.47\n\n\nCode\nm1 &lt;- mean(X)\nmx &lt;- mean(x1)\nmy &lt;- mean(y1)\nsx_2 &lt;- var(x1)\nsx_2\n\n\n[1] 7.094982\n\n\nCode\nsy_2 &lt;- var(y1)\nsy_2\n\n\n[1] 46988.86\n\n\nCode\ns_xy &lt;- cov(x1,y1)\nbeta_hat &lt;- s_xy/sx_2\ny_bar_reg &lt;- my + beta_hat*(m1 - mx)\n\nprint(paste(\"Estimated mean using regression method is\",y_bar_reg))\n\n\n[1] \"Estimated mean using regression method is 183.212596472875\"\n\n\nCode\n#---95%CI for population mean---#\nr &lt;- cor(x1, y1)\nMSE_reg &lt;- (1/n - 1/N) * (sy_2 - r^2 * s_xy)\n\n# Calculate t-critical value\nalpha &lt;- 0.05\ndf &lt;- n - 2  # degrees of freedom for regression\nt &lt;- qt(1 - alpha/2, df)\n\n# Confidence interval\nLCL_reg &lt;- y_bar_reg - t * sqrt(MSE_reg)\nUCL_reg &lt;- y_bar_reg + t * sqrt(MSE_reg)\nCI_reg &lt;- c(LCL_reg, UCL_reg)\n\ncat(\"95% Confidence Interval: [\", round(LCL_reg, 2), \",\", round(UCL_reg, 2),\n    \"] lakh tonnes\\n\")\n\n\n95% Confidence Interval: [ 72.12 , 294.3 ] lakh tonnes\n\n\nQ.(2) Excel Sheet Maharashtra sex ratio gives India’s census data of 2011, in which the number of females per thousand is measured district-wise and strata are regions. Draw a random sample by using SRSWOR of size 18 under the proportional allocation of stratified sampling. Estimate the average sex ratio and obtain the variance of the estimator.\n\n\nCode\nsex_ratio_data &lt;- readxl::read_xlsx(\"data/maharashtra_sex_ratio_2011.xlsx\")\ncolnames(sex_ratio_data) &lt;- c(\"Sr_No\", \"Region\", \"District\", \"SexRatio\")\nN &lt;- nrow(sex_ratio_data)\nn &lt;- 18\nstratified_sample_data &lt;- sex_ratio_data |&gt; \n  group_by(Region) |&gt; \n  sample_frac(size = n / N)\nstratified_sample_data\n\n\n# A tibble: 17 × 4\n# Groups:   Region [6]\n   Sr_No Region              District   SexRatio\n   &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;         &lt;dbl&gt;\n 1    27 Khandesh            Dhule           941\n 2    28 Khandesh            Jalgaon         922\n 3    16 Konkan              Thane           880\n 4    18 Konkan              Raigad          955\n 5    20 Konkan              Sindhudurg     1037\n 6    19 Konkan              Ratnagiri      1123\n 7     6 Marathwada          Aurangabad      917\n 8     9 Marathwada          Osmanabad       920\n 9    13 Marathwada          Hingoli         935\n10    11 Marathwada          Latur           924\n11    36 Paschim Maharashtra Solapur         932\n12    34 Paschim Maharashtra Sangli          964\n13    22 Vidarbha            Chandrapur      959\n14    26 Vidarbha            Wardha          946\n15    21 Vidarbha            Bhandara        984\n16     3 Vidarbha (Varhad)   Buldana         928\n17     4 Vidarbha (Varhad)   Yavatmal        947\n\n\nCode\npopulation_summary &lt;- sex_ratio_data |&gt; \n  group_by(Region) |&gt; \n  summarise(N_h = n()) |&gt; \n  mutate(N = sum(N_h),\n         W_h = N_h / N)\n\nsample_summary &lt;- stratified_sample_data |&gt;\n  group_by(Region) |&gt; \n  summarise(n_h = n(),\n            y_bar_h = mean(SexRatio),\n            s_h2 = var(SexRatio))\nstratified_summary &lt;- merge(population_summary, sample_summary, by = \"Region\")\nstratified_summary &lt;- stratified_summary |&gt; \n  mutate(weighted_mean = W_h * y_bar_h,\n         weighted_variance = (W_h^2) * (1 - n_h / N_h) * (s_h2 / n_h))\nstratified_summary\n\n\n               Region N_h  N       W_h n_h y_bar_h     s_h2 weighted_mean\n1            Khandesh   5 36 0.1388889   2  931.50   180.50      129.3750\n2              Konkan   7 36 0.1944444   4  998.75 10972.25      194.2014\n3          Marathwada   8 36 0.2222222   4  924.00    62.00      205.3333\n4 Paschim Maharashtra   5 36 0.1388889   2  948.00   512.00      131.6667\n5            Vidarbha   6 36 0.1666667   3  963.00   373.00      160.5000\n6   Vidarbha (Varhad)   5 36 0.1388889   2  937.50   180.50      130.2083\n  weighted_variance\n1          1.044560\n2         44.447772\n3          0.382716\n4          2.962963\n5          1.726852\n6          1.044560\n\n\nCode\ny_bar_strat &lt;- sum(stratified_summary$weighted_mean)\nvar_y_bar_strat &lt;- sum(stratified_summary$weighted_variance)\nvar_y_bar_strat\n\n\n[1] 51.60942\n\n\nQ.(3) Draw a random sample using SRSWOR of size 18 under optimal allocation of stratified sampling from Sex ratio data. Estimate the average sex ratio and obtain the variance of the estimator.\n\n\nCode\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(tidyr)\n\n# Load data\nsex_ratio_data &lt;- readxl::read_xlsx(\"data/maharashtra_sex_ratio_2011.xlsx\")\ncolnames(sex_ratio_data) &lt;- c(\"Sr_No\", \"Region\", \"District\", \"SexRatio\")\n\n# Total population size and sample size\nN &lt;- nrow(sex_ratio_data)\nn &lt;- 18\n\n# Compute strata-level statistics\npopulation_stats &lt;- sex_ratio_data |&gt; \n  group_by(Region) |&gt; \n  summarise(\n    N_h = n(),\n    S_h = sd(SexRatio)\n  ) |&gt; \n  ungroup() |&gt; \n  replace_na(list(S_h = 0)) |&gt; \n  mutate(\n    N = sum(N_h),\n    W_h = N_h / N,\n    Nh_Sh = N_h * S_h\n  )\n\n# Compute sum of Nh * Sh\nsum_Nh_Sh &lt;- sum(population_stats$Nh_Sh)\n\n# Initial optimal n_h\nsample_sizes_nh &lt;- population_stats |&gt; \n  mutate(\n    n_h_frac = n * (Nh_Sh / sum_Nh_Sh),\n    n_h = floor(n_h_frac)\n  )\n\n# Each stratum gets at least 1\nsample_sizes_nh$n_h &lt;- ifelse(sample_sizes_nh$n_h &lt; 1, 1, sample_sizes_nh$n_h)\n\n# Ensure n_h does not exceed stratum population\nsample_sizes_nh$n_h &lt;- pmin(sample_sizes_nh$n_h, sample_sizes_nh$N_h)\n\n# Adjust remaining to hit total n exactly\nadjust_allocation &lt;- function(df, target_n) {\n  repeat {\n    diff &lt;- target_n - sum(df$n_h)\n    if (diff == 0) break\n    \n    # allowable strata that can increase/decrease sample\n    if (diff &gt; 0) {\n      eligible &lt;- which(df$n_h &lt; df$N_h)\n      if (length(eligible) == 0) break\n      add &lt;- eligible[order(df$n_h_frac[eligible] - df$n_h[eligible],\n                            decreasing = TRUE)][1:min(diff, length(eligible))]\n      df$n_h[add] &lt;- df$n_h[add] + 1\n    } else {\n      eligible &lt;- which(df$n_h &gt; 1)\n      remove &lt;- eligible[order(df$n_h_frac[eligible]\n                               - df$n_h[eligible])][1:min(abs(diff),\n                                                          length(eligible))]\n      df$n_h[remove] &lt;- df$n_h[remove] - 1\n    }\n  }\n  df\n}\n\nsample_sizes_nh &lt;- adjust_allocation(sample_sizes_nh, n)\n\ncat(\"\\n Optimal allocation sample sizes (n_h) per Region:\\n\")\n\n\n\n Optimal allocation sample sizes (n_h) per Region:\n\n\nCode\nprint(sample_sizes_nh |&gt; select(Region, N_h, S_h, n_h))\n\n\n# A tibble: 6 × 4\n  Region                N_h   S_h   n_h\n  &lt;chr&gt;               &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 Khandesh                5  19.1     2\n2 Konkan                  7 106.      7\n3 Marathwada              8  10.1     2\n4 Paschim Maharashtra     5  29.2     3\n5 Vidarbha                6  20.3     2\n6 Vidarbha (Varhad)       5  10.3     2\n\n\nCode\ncat(\"\\n Final total sample size n =\", sum(sample_sizes_nh$n_h), \"\\n\")\n\n\n\n Final total sample size n = 18 \n\n\nCode\n# --------------------------\n# Draw Stratified Sample\n# --------------------------\ndata_with_nh &lt;- sex_ratio_data |&gt;\n  left_join(sample_sizes_nh |&gt; select(Region, n_h), by = \"Region\")\n\nstratified_sample_data_optimal &lt;- data_with_nh |&gt;\n  group_by(Region) |&gt;\n  group_modify(~ slice_sample(.x, n = .x$n_h[1])) |&gt;\n  ungroup()\n\ncat(\"\\n Final Sample drawn: \", nrow(stratified_sample_data_optimal),\n    \" observations\\n\")\n\n\n\n Final Sample drawn:  18  observations\n\n\nCode\n# --------------------------\n# Compute Weighted Stratified Mean\n# --------------------------\nsample_means_h &lt;- stratified_sample_data_optimal |&gt; \n  group_by(Region) |&gt; \n  summarise(y_bar_h = mean(SexRatio), .groups = \"drop\")\n\nest_mean_h &lt;- population_stats |&gt;\n  select(Region, W_h) |&gt;\n  left_join(sample_means_h, by = \"Region\") |&gt;\n  mutate(weighted_mean = W_h * y_bar_h)\n\ny_bar_strat_optimal &lt;- sum(est_mean_h$weighted_mean)\n\ncat(\"\\n Estimated Stratified Mean (Optimal Allocation):\",\n    y_bar_strat_optimal, \"\\n\")\n\n\n\n Estimated Stratified Mean (Optimal Allocation): 944.2824 \n\n\nCode\nsample_vars_h &lt;- stratified_sample_data_optimal |&gt; \n  group_by(Region) |&gt; \n  summarise(s_h2 = var(SexRatio)) |&gt; \n  replace_na(list(s_h2 = 0))\n\nvar_data &lt;- population_stats |&gt;\n  select(Region, W_h, N_h) |&gt;\n  left_join(sample_sizes_nh |&gt; select(Region, n_h), by = \"Region\")  |&gt; \n  left_join(sample_vars_h, by = \"Region\") |&gt; \n  replace_na(list(s_h2 = 0)) |&gt; \n  mutate(stratum_var_contrib = if_else(\n      n_h &gt; 0,  # Only calculate for strata we sampled from\n      (W_h^2) * (1 - n_h / N_h) * (s_h2 / n_h),\n      0         # Contribution is 0 if n_h = 0\n    ))\n\nest_var_strat_optimal &lt;- sum(var_data$stratum_var_contrib)\n\nprint(paste(\"Variance of estimated mean (Optimal Allocation):\",\n            est_var_strat_optimal))\n\n\n[1] \"Variance of estimated mean (Optimal Allocation): 20.3923825445816\"\n\n\nQ.(4) Estimate the mean fuelwood_data consumption of the households of forest villages in the Dehradun district of Uttarakhand state and its standard error using the method of stratified random sampling. Three strata were constructed using the criterion of distance from the forest. Find the estimated mean, total, and their variances. Data are shown excel sheet fuelwood_data consumption\n\n\nCode\nfuelwood_data &lt;- readxl::read_xlsx(\"data/fuelwood_consumption.xlsx\")\ncolnames(fuelwood_data) &lt;- c(\"Stratum\",\"Selected_Unit\", \"Consumption\")\n# Population size\nN &lt;- nrow(fuelwood_data)\n\n# Stratified Statistics\nstats &lt;- fuelwood_data|&gt;\n  group_by(Stratum)|&gt;\n  summarise(\n    N_h = n(),\n    ybar_h = mean(Consumption),\n    S2_h = var(Consumption)\n  )|&gt;\n  mutate(W_h = N_h / N)\n\nstats\n\n\n# A tibble: 3 × 5\n  Stratum   N_h ybar_h  S2_h   W_h\n  &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 I          10   4.22 1.05  0.435\n2 II          5   4.42 0.335 0.217\n3 III         8   5.46 2.00  0.348\n\n\nCode\n# Estimated Stratified Mean\nybar_st &lt;- sum(stats$W_h * stats$ybar_h)\nybar_st\n\n\n[1] 4.692174\n\n\nCode\n# Variance of Stratified Mean\nvar_ybar_st &lt;- sum((stats$W_h^2 * stats$S2_h) / stats$N_h)\nvar_ybar_st\n\n\n[1] 0.05323138\n\n\nCode\nSE_ybar_st &lt;- sqrt(var_ybar_st)\nSE_ybar_st\n\n\n[1] 0.2307193\n\n\nCode\n# Estimated Total fuelwood_data Consumption\nT_st &lt;- N * ybar_st\nT_st\n\n\n[1] 107.92\n\n\nCode\n# Variance of Total\nvar_Tst &lt;- (N^2) * var_ybar_st\nvar_Tst\n\n\n[1] 28.1594\n\n\nEstimated Mean Consumption: 4.6922\nVariance of Mean Estimator: 0.053231\nStandard Error (Mean): 0.230719\nEstimated Total Consumption: 107.92\nVariance of Total Estimator: 28.1594\nQ.(5) ICFRE has implemented a tree improvement programme of Gmelina arborea and has planned to release high productive pest-tolerant clones. Compute the sample size in each stratum under proportional and Neyman allocation. Calculate the sampling variance of the survived trees from the sample, if the plots were selected under\n\nproportional allocation and SRSWOR,\nNeyman allocation and SRSWOR.\n\nData are shown in excel sheet Survival of clones\n\n\nCode\nsurvival_data &lt;- readxl::read_xlsx(\"data/Survival of clones.xlsx\")\ncolnames(survival_data) &lt;- c(\"Stratum\", \"N_h\",\"mean_h\", \"Sd_h\")\n# Total population plots\nN &lt;- sum(survival_data$N_h)\n\n# Decide sample size\nn &lt;- 100  # &lt;-- change here if a different sample size is specified\n\n# Weight for each stratum\nsurvival_data &lt;- survival_data|&gt;mutate(W_h = N_h / N)\n\n# Proportional Allocation\nsurvival_data &lt;- survival_data|&gt;\n  mutate(n_prop = round(n * W_h))\n\n# Neyman Allocation\nsum_Nh_Sh &lt;- sum(survival_data$N_h * survival_data$Sd_h)\nsurvival_data &lt;- survival_data|&gt;\n  mutate(n_neyman = round(n * (N_h * Sd_h) / sum_Nh_Sh))\n\nsurvival_data\n\n\n# A tibble: 5 × 7\n  Stratum   N_h mean_h  Sd_h   W_h n_prop n_neyman\n  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;\n1 I         200    5.4   2.5 0.118     12        3\n2 II        300   16.5  15.5 0.176     18       27\n3 III       250   25.3  20.5 0.147     15       30\n4 IV        430   15.6  12.5 0.253     25       31\n5 V         520    7.5   3   0.306     31        9\n\n\nCode\n# Check totals:\nsum_prop &lt;- sum(survival_data$n_prop)\nsum_neyman &lt;- sum(survival_data$n_neyman)\n\ncat(\"\\nTotal sample size under proportional allocation:\", sum_prop)\n\n\n\nTotal sample size under proportional allocation: 101\n\n\nCode\ncat(\"\\nTotal sample size under Neyman allocation:\", sum_neyman)\n\n\n\nTotal sample size under Neyman allocation: 100\n\n\nCode\n# Proportional Allocation Variance\nvar_prop &lt;- sum((survival_data$W_h^2 * survival_data$Sd_h^2) \n                / survival_data$n_prop * (1 - survival_data$n_prop\n                                          / survival_data$N_h))\n\n# Neyman Allocation Variance\nvar_neyman &lt;- sum((survival_data$W_h^2 * survival_data$Sd_h^2)\n                  / survival_data$n_neyman * (1 - survival_data$n_neyman\n                                              / survival_data$N_h))\n\n\n\n0.1 Stratified Sampling Variance Results\nVariance under proportional allocation: 1.369204\nStandard Error (Proportional): 1.17013\nVariance under Neyman allocation: 0.938335\nStandard Error (Neyman): 0.968677\nQ.(6) The experiment deals with the bamboo species Melocanna bamboosides with vessel lengths: 27, 38, 53, 43, 32, 45, 25, 32, 43, 22, 38, 42, 39, 34, 25, 27, 33, 22, 34, 48, 41, 34, 23, 37, 32, 37, 44, 41, 23, 41, 20, 29, 28, 39, 32, 27, 22, 37, 23, 32, 27, 23, 31, 26, 35, 43, 26, 24, 34, 22, 27, 30, 19, 12, 11, 14, 24, 25, 27, 20. Draw a systematic sample of size 6 and estimate the average vessel length.\n\n\nCode\n# Population data: vessel lengths\nvessel_lengths &lt;- c(27, 38, 53, 43, 32, 45, 25, 32, 43, 22, 38, 42, 39, 34, 25,\n                    27, 33, 22, 34, 48, 41, 34, 23, 37, 32, 37, 44, 41, 23, 41,\n                    20, 29, 28, 39, 32, 27, 22, 37, 23, 32, 27, 23, 31, 26, 35,\n                    43, 26, 24, 34, 22, 27, 30, 19, 12, 11, 14, 24, 25, 27, 20)\n\n# Population size\nN &lt;- length(vessel_lengths)\n\n# Sample size\nn &lt;- 6\n\n# Calculate sampling interval\nk &lt;- floor(N / n)\n\ncat(\"Population size (N):\", N, \"\\n\")\n\n\nPopulation size (N): 60 \n\n\nCode\ncat(\"Sample size (n):\", n, \"\\n\")\n\n\nSample size (n): 6 \n\n\nCode\ncat(\"Sampling interval (k):\", k, \"\\n\\n\")\n\n\nSampling interval (k): 10 \n\n\nCode\n# Select random start between 1 and k\nset.seed(123)  # For reproducibility\nr &lt;- sample(1:k, size = 1)\n\ncat(\"Random start (r):\", r, \"\\n\\n\")\n\n\nRandom start (r): 3 \n\n\nCode\n# Draw systematic sample\nsample_indices &lt;- r + (0:(n - 1)) * k\nsystematic_sample &lt;- vessel_lengths[sample_indices]\n\ncat(\"Selected indices:\", sample_indices, \"\\n\")\n\n\nSelected indices: 3 13 23 33 43 53 \n\n\nCode\ncat(\"Systematic sample:\", systematic_sample, \"\\n\\n\")\n\n\nSystematic sample: 53 39 23 28 31 19 \n\n\nCode\n# Estimate average vessel length\ny_bar_sys &lt;- mean(systematic_sample)\n\ncat(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================ \n\n\nCode\ncat(\"SYSTEMATIC SAMPLING RESULTS\\n\")\n\n\nSYSTEMATIC SAMPLING RESULTS\n\n\nCode\ncat(strrep(\"=\", 60), \"\\n\")\n\n\n============================================================ \n\n\nCode\ncat(\"Estimated average vessel length (ȳ_sys):\", round(y_bar_sys, 2), \"\\n\")\n\n\nEstimated average vessel length (ȳ_sys): 32.17 \n\n\nCode\ncat(\"Population mean (for comparison):\", round(mean(vessel_lengths), 2), \"\\n\")\n\n\nPopulation mean (for comparison): 30.73 \n\n\nExplanation:\nSystematic Sampling Formula:\n\nSampling interval: \\(k = \\lfloor N/n \\rfloor = \\lfloor 60/6 \\rfloor = 10\\)\nRandom start: \\(r \\sim \\text{Uniform}(1, 2, \\ldots, k)\\)\nSelected units: \\(r, r+k, r+2k, \\ldots, r+(n-1)k\\)\n\nEstimator:\n\\[\\bar{y}_{sys} = \\frac{1}{n}\\sum_{i=1}^{n}y_i\\]\nThe systematic sample mean provides an unbiased estimate of the population mean under the assumption that there is no periodic pattern in the population.\nQ.(7) Water samples collected from different locations of Pune district are clustered in excel sheet Water Quality Pune. Draw a random sample of 3 clusters and obtain the average conductivity (ppm) of the water and its variance.\n\n\nCode\n# Load water quality data\nwater_data &lt;- readxl::read_xlsx(\"data/Water quality Pune.xlsx\")\n\n# Display structure of data\ncat(\"Data structure:\\n\")\n\n\nData structure:\n\n\nCode\nprint(head(water_data))\n\n\n# A tibble: 6 × 9\n  `Sr. No.` Cluster   Site    PH `Conductivity (ppm)` Chloride Sulfate\n      &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;                &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;\n1         1 Baramati     1  7.4                   730      332     157\n2         2 Baramati     2  8.21                  280      113      27\n3         3 Baramati     3  7.48                  460      119     838\n4         4 Baramati     4  7.62                  450      142      71\n5         5 Baramati     5  7.97                  400      151     192\n6         6 Baramati     6  7.96                  480      156     192\n# ℹ 2 more variables: Phosphorous &lt;dbl&gt;, Nitrate &lt;dbl&gt;\n\n\nCode\ncat(\"\\n\")\n\n\nCode\n# Get unique clusters\nclusters &lt;- unique(water_data$Cluster)\nM &lt;- length(clusters)  # Total number of clusters\nm &lt;- 3  # Number of clusters to sample\n\ncat(\"Total number of clusters (M):\", M, \"\\n\")\n\n\nTotal number of clusters (M): 6 \n\n\nCode\ncat(\"Number of clusters to sample (m):\", m, \"\\n\\n\")\n\n\nNumber of clusters to sample (m): 3 \n\n\nCode\n# Draw random sample of 3 clusters using SRSWOR\nset.seed(123)  # For reproducibility\nsampled_clusters &lt;- sample(clusters, size = m, replace = FALSE)\n\ncat(\"Sampled clusters:\", sampled_clusters, \"\\n\\n\")\n\n\nSampled clusters: Purandar Indapur Daund \n\n\nCode\n# Extract data from sampled clusters\nsample_data &lt;- water_data[water_data$Cluster %in% sampled_clusters, ]\n\ncat(\"Sample size:\", nrow(sample_data), \"observations\\n\\n\")\n\n\nSample size: 18 observations\n\n\nCode\n# Calculate cluster means\ncluster_means &lt;- tapply(sample_data$`Conductivity (ppm)`, \n                        sample_data$Cluster, \n                        mean)\n\ncat(\"Cluster means (ȳ_i):\\n\")\n\n\nCluster means (ȳ_i):\n\n\nCode\nprint(round(cluster_means, 2))\n\n\n   Daund  Indapur Purandar \n  615.00   683.33   305.00 \n\n\nCode\ncat(\"\\n\")\n\n\nCode\n# One-stage cluster sampling estimator\ny_bar_cluster &lt;- mean(cluster_means)\n\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"CLUSTER SAMPLING RESULTS\\n\")\n\n\nCLUSTER SAMPLING RESULTS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Average conductivity estimate (ȳ_cl):\", round(y_bar_cluster, 2), \"ppm\\n\\n\")\n\n\nAverage conductivity estimate (ȳ_cl): 534.44 ppm\n\n\nCode\n# Calculate variance of cluster mean estimator\n# Between-cluster variance\ns_b_squared &lt;- var(cluster_means)\n\n# Finite Population Correction\nfpc &lt;- (M - m) / M\n\n# Variance of cluster mean\nvar_y_cluster &lt;- fpc * s_b_squared / m\n\n# Standard error\nse_y_cluster &lt;- sqrt(var_y_cluster)\n\ncat(\"Variance Components:\\n\")\n\n\nVariance Components:\n\n\nCode\ncat(\"  Between-cluster variance (s²_b):\", round(s_b_squared, 4), \"\\n\")\n\n\n  Between-cluster variance (s²_b): 40650.93 \n\n\nCode\ncat(\"  FPC factor (1 - m/M):\", round(fpc, 4), \"\\n\")\n\n\n  FPC factor (1 - m/M): 0.5 \n\n\nCode\ncat(\"  Number of sampled clusters (m):\", m, \"\\n\\n\")\n\n\n  Number of sampled clusters (m): 3 \n\n\nCode\ncat(\"Variance of cluster mean estimator:\", round(var_y_cluster, 4), \"\\n\")\n\n\nVariance of cluster mean estimator: 6775.154 \n\n\nCode\ncat(\"Standard error:\", round(se_y_cluster, 4), \"ppm\\n\\n\")\n\n\nStandard error: 82.3113 ppm\n\n\nCode\n# 95% Confidence Interval\nt_critical &lt;- qt(0.975, df = m - 1)\nci_lower &lt;- y_bar_cluster - t_critical * se_y_cluster\nci_upper &lt;- y_bar_cluster + t_critical * se_y_cluster\n\ncat(\"95% Confidence Interval: [\", round(ci_lower, 2), \",\", \n    round(ci_upper, 2), \"] ppm\\n\")\n\n\n95% Confidence Interval: [ 180.29 , 888.6 ] ppm\n\n\nExplanation:\nOne-Stage Cluster Sampling Formulas:\nCluster Mean Estimator:\n\\[\\bar{y}_{cl} = \\frac{1}{m}\\sum_{i=1}^{m}\\bar{y}_i\\]\nwhere \\(\\bar{y}_i\\) is the mean conductivity in cluster \\(i\\).\nVariance of Cluster Mean:\n\\[V(\\bar{y}_{cl}) = \\left(1 - \\frac{m}{M}\\right)\\frac{s_b^2}{m}\\]\nwhere:\n\n\\(M\\) = total number of clusters in population\n\\(m\\) = number of clusters sampled\n\\(s_b^2\\) = between-cluster variance = \\(\\frac{1}{m-1}\\sum_{i=1}^{m}(\\bar{y}_i - \\bar{y}_{cl})^2\\)\n\\(\\left(1 - \\frac{m}{M}\\right)\\) = finite population correction factor\n\nKey Points:\n\nCluster sampling is efficient when clusters are heterogeneous (different from each other) but internally homogeneous\nThe variance depends on between-cluster variability\nMore homogeneous clusters (similar means) → lower variance\nMore heterogeneous clusters (different means) → higher variance\n\nQ.(8) Draw a random sample of 3 clusters and then draw a random sample of size 3 from each of the selected clusters. Obtain the average conductivity of water and its variance. Use the R code.\n\n\nCode\n# TWO-STAGE CLUSTER SAMPLING\n# Load water quality data\nwater_data &lt;- readxl::read_xlsx(\"data/Water quality Pune.xlsx\")\n\n# Get unique clusters\nclusters &lt;- unique(water_data$Cluster)\nM &lt;- length(clusters)  # Total number of clusters\nm &lt;- 3  # Number of clusters to sample (first stage)\nn_per_cluster &lt;- 3  # Sample size from each cluster (second stage)\n\ncat(\"TWO-STAGE CLUSTER SAMPLING\\n\")\n\n\nTWO-STAGE CLUSTER SAMPLING\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Total number of clusters (M):\", M, \"\\n\")\n\n\nTotal number of clusters (M): 6 \n\n\nCode\ncat(\"Clusters to sample (m):\", m, \"\\n\")\n\n\nClusters to sample (m): 3 \n\n\nCode\ncat(\"Units per cluster (n_i):\", n_per_cluster, \"\\n\\n\")\n\n\nUnits per cluster (n_i): 3 \n\n\nCode\n# STAGE 1: Select 3 clusters using SRSWOR\nset.seed(456)  # For reproducibility\nsampled_clusters &lt;- sample(clusters, size = m, replace = FALSE)\n\ncat(\"STAGE 1: Selected clusters:\", sampled_clusters, \"\\n\\n\")\n\n\nSTAGE 1: Selected clusters: Khed Indapur Purandar \n\n\nCode\n# Get cluster sizes\ncluster_sizes &lt;- table(water_data$Cluster)\nN_i &lt;- cluster_sizes[as.character(sampled_clusters)]\n\ncat(\"Cluster sizes (N_i):\\n\")\n\n\nCluster sizes (N_i):\n\n\nCode\nprint(N_i)\n\n\n\n    Khed  Indapur Purandar \n       6        6        6 \n\n\nCode\ncat(\"\\n\")\n\n\nCode\n# STAGE 2: Sample n_per_cluster units from each selected cluster\ntwo_stage_sample &lt;- NULL\ncluster_sample_means &lt;- numeric(m)\ncluster_sample_vars &lt;- numeric(m)\n\ncat(\"STAGE 2: Sampling from each cluster\\n\")\n\n\nSTAGE 2: Sampling from each cluster\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\nfor (i in 1:m) {\n  cluster_id &lt;- sampled_clusters[i]\n  \n  # Get all units from this cluster\n  cluster_data &lt;- water_data[water_data$Cluster == cluster_id, ]\n  \n  # Sample n_per_cluster units from this cluster\n  sampled_indices &lt;- sample(1:nrow(cluster_data), \n                             size = n_per_cluster, \n                             replace = FALSE)\n  cluster_subsample &lt;- cluster_data[sampled_indices, ]\n  \n  # Calculate cluster mean and variance from subsample\n  cluster_sample_means[i] &lt;- mean(cluster_subsample$`Conductivity (ppm)`)\n  cluster_sample_vars[i] &lt;- var(cluster_subsample$`Conductivity (ppm)`)\n  \n  # Store subsample\n  two_stage_sample &lt;- rbind(two_stage_sample, cluster_subsample)\n  \n  cat(\"Cluster\", cluster_id, \":\\n\")\n  cat(\"  Sampled values:\", \n      round(cluster_subsample$`Conductivity (ppm)`, 2), \"\\n\")\n  cat(\"  Subsample mean (ȳ_i):\", round(cluster_sample_means[i], 2), \"\\n\")\n  cat(\"  Subsample variance (s²_i):\", round(cluster_sample_vars[i], 4), \"\\n\\n\")\n}\n\n\nCluster Khed :\n  Sampled values: 430 780 480 \n  Subsample mean (ȳ_i): 563.33 \n  Subsample variance (s²_i): 35833.33 \n\nCluster Indapur :\n  Sampled values: 880 1040 510 \n  Subsample mean (ȳ_i): 810 \n  Subsample variance (s²_i): 73900 \n\nCluster Purandar :\n  Sampled values: 550 70 180 \n  Subsample mean (ȳ_i): 266.67 \n  Subsample variance (s²_i): 63233.33 \n\n\nCode\n# Two-stage estimator: mean of cluster means\ny_bar_2stage &lt;- mean(cluster_sample_means)\n\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"TWO-STAGE CLUSTER SAMPLING RESULTS\\n\")\n\n\nTWO-STAGE CLUSTER SAMPLING RESULTS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Average conductivity estimate (ȳ_2s):\", round(y_bar_2stage, 2), \"ppm\\n\\n\")\n\n\nAverage conductivity estimate (ȳ_2s): 546.67 ppm\n\n\nCode\n# VARIANCE CALCULATION for Two-Stage Cluster Sampling\n# Component 1: Between-cluster variance\ns_b_squared_2s &lt;- var(cluster_sample_means)\nfpc_clusters &lt;- (M - m) / M\nvar_between &lt;- fpc_clusters * s_b_squared_2s / m\n\n# Component 2: Within-cluster variance\n# Average of within-cluster variances weighted by sampling fractions\nvar_within &lt;- 0\nfor (i in 1:m) {\n  fpc_within &lt;- (N_i[i] - n_per_cluster) / N_i[i]\n  var_within &lt;- var_within + fpc_within * cluster_sample_vars[i] / n_per_cluster\n}\nvar_within &lt;- var_within / m\n\n# Total variance\nvar_y_2stage &lt;- var_between + var_within\nse_y_2stage &lt;- sqrt(var_y_2stage)\n\ncat(\"Variance Components:\\n\")\n\n\nVariance Components:\n\n\nCode\ncat(\"  Between-cluster variance component:\", round(var_between, 4), \"\\n\")\n\n\n  Between-cluster variance component: 12335.19 \n\n\nCode\ncat(\"  Within-cluster variance component:\", round(var_within, 4), \"\\n\")\n\n\n  Within-cluster variance component: 9609.259 \n\n\nCode\ncat(\"  Total variance V(ȳ_2s):\", round(var_y_2stage, 4), \"\\n\")\n\n\n  Total variance V(ȳ_2s): 21944.44 \n\n\nCode\ncat(\"  Standard error:\", round(se_y_2stage, 4), \"ppm\\n\\n\")\n\n\n  Standard error: 148.1366 ppm\n\n\nCode\n# 95% Confidence Interval\n# Use t-distribution with m-1 degrees of freedom (conservative)\nt_crit_2s &lt;- qt(0.975, df = m - 1)\nci_lower_2s &lt;- y_bar_2stage - t_crit_2s * se_y_2stage\nci_upper_2s &lt;- y_bar_2stage + t_crit_2s * se_y_2stage\n\ncat(\"95% Confidence Interval: [\", round(ci_lower_2s, 2), \",\", \n    round(ci_upper_2s, 2), \"] ppm\\n\\n\")\n\n\n95% Confidence Interval: [ -90.71 , 1184.05 ] ppm\n\n\nCode\n# Summary table\nsummary_table &lt;- data.frame(\n  Cluster = sampled_clusters,\n  N_i = as.numeric(N_i),\n  n_i = rep(n_per_cluster, m),\n  y_bar_i = round(cluster_sample_means, 2),\n  s2_i = round(cluster_sample_vars, 4)\n)\n\ncat(\"Summary Table:\\n\")\n\n\nSummary Table:\n\n\nCode\nprint(summary_table)\n\n\n   Cluster N_i n_i y_bar_i     s2_i\n1     Khed   6   3  563.33 35833.33\n2  Indapur   6   3  810.00 73900.00\n3 Purandar   6   3  266.67 63233.33\n\n\nExplanation:\nTwo-Stage Cluster Sampling Formulas:\nStage 1: Select \\(m\\) clusters from \\(M\\) total clusters using SRSWOR\nStage 2: From each selected cluster \\(i\\), select \\(n_i\\) units from \\(N_i\\) total units using SRSWOR\nTwo-Stage Mean Estimator:\n\\[\\bar{y}_{2s} = \\frac{1}{m}\\sum_{i=1}^{m}\\bar{y}_i\\]\nwhere \\(\\bar{y}_i\\) is the mean of the subsample from cluster \\(i\\).\nVariance of Two-Stage Mean:\n\\[V(\\bar{y}_{2s}) = \\underbrace{\\left(1 - \\frac{m}{M}\\right)\\frac{s_b^2}{m}}_{\\text{Between-cluster}} + \\underbrace{\\frac{1}{m}\\sum_{i=1}^{m}\\left(1 - \\frac{n_i}{N_i}\\right)\\frac{s_i^2}{n_i}}_{\\text{Within-cluster}}\\]\nComponents:\n\nBetween-cluster variance - Variability due to selecting only \\(m\\) out of \\(M\\) clusters\nWithin-cluster variance - Variability due to sampling only \\(n_i\\) out of \\(N_i\\) units from each cluster\n\nKey Differences from One-Stage:\n\nOne-stage: All units in selected clusters are measured\nTwo-stage: Only a subsample of units from selected clusters is measured\nTwo-stage has additional variance from the second-stage sampling\nTwo-stage is more cost-effective when measuring all units is expensive\n\nQ.(9) Select a first-phase sample of 20 units by SRSWOR sampling and note only the age of a person in a block from the selected units present in excel sheet sleeping hours. From the selected first-phase sample of 20 units, select a subsample of 10 units and note age and sleeping hours. Estimate the average sleeping hours using a ratio estimator in two-phase sampling. Deduce the 95% confidence interval.\n\n\nCode\n# Load sleeping hours data\nsleep_data &lt;- readxl::read_xlsx(\"data/Sleeping Hours.xlsx\")\n\n# Variables\ny &lt;- sleep_data$`Number of hours of sleep`  # Variable of interest (expensive)\nx &lt;- sleep_data$Age                          # Auxiliary variable (cheap)\n\nN &lt;- length(y)  # Population size\nn1 &lt;- 20        # First-phase sample size\nn2 &lt;- 10        # Second-phase sample size\n\ncat(\"TWO-PHASE RATIO ESTIMATION\\n\")\n\n\nTWO-PHASE RATIO ESTIMATION\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Population size (N):\", N, \"\\n\")\n\n\nPopulation size (N): 50 \n\n\nCode\ncat(\"First-phase sample size (n'):\", n1, \"\\n\")\n\n\nFirst-phase sample size (n'): 20 \n\n\nCode\ncat(\"Second-phase sample size (n):\", n2, \"\\n\\n\")\n\n\nSecond-phase sample size (n): 10 \n\n\nCode\n# PHASE 1: Select 20 units by SRSWOR and measure only Age (x)\nset.seed(789)\nphase1_indices &lt;- sample(1:N, n1, replace = FALSE)\n\n# First-phase data (only x is measured)\nx_phase1 &lt;- x[phase1_indices]\n\ncat(\"PHASE 1: Measure auxiliary variable (Age) only\\n\")\n\n\nPHASE 1: Measure auxiliary variable (Age) only\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices:\", phase1_indices, \"\\n\")\n\n\nSelected indices: 45 48 12 42 26 35 37 36 3 6 41 29 21 49 2 24 50 30 39 27 \n\n\nCode\ncat(\"Ages measured:\", x_phase1, \"\\n\\n\")\n\n\nAges measured: 70.84 60.06 64.94 76.66 64.06 63.06 68.55 71.14 64.49 58.91 64.89 76.42 67.1 68.19 73.82 70.85 58.66 57.91 51.64 70.33 \n\n\nCode\n# Calculate first-phase mean of x\nx_bar_prime &lt;- mean(x_phase1)\n\ncat(\"First-phase mean of Age (x̄'):\", round(x_bar_prime, 2), \"years\\n\\n\")\n\n\nFirst-phase mean of Age (x̄'): 66.13 years\n\n\nCode\n# PHASE 2: Select 10 units from phase 1 sample and measure both Age and Sleep\nset.seed(790)\nphase2_indices_within &lt;- sample(1:n1, n2, replace = FALSE)\nphase2_indices &lt;- phase1_indices[phase2_indices_within]\n\n# Second-phase data (both x and y measured)\nx_phase2 &lt;- x[phase2_indices]\ny_phase2 &lt;- y[phase2_indices]\n\ncat(\"PHASE 2: Measure both Age and Sleeping Hours\\n\")\n\n\nPHASE 2: Measure both Age and Sleeping Hours\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices from phase 1:\", phase2_indices_within, \"\\n\")\n\n\nSelected indices from phase 1: 8 3 9 11 17 19 2 15 6 20 \n\n\nCode\ncat(\"Actual indices in population:\", phase2_indices, \"\\n\")\n\n\nActual indices in population: 36 12 3 41 50 39 48 2 35 27 \n\n\nCode\ncat(\"Ages:\", x_phase2, \"\\n\")\n\n\nAges: 71.14 64.94 64.49 64.89 58.66 51.64 60.06 73.82 63.06 70.33 \n\n\nCode\ncat(\"Sleep hours:\", round(y_phase2, 2), \"\\n\\n\")\n\n\nSleep hours: 326.33 401.95 395.99 419.98 412.7 434.5 425.12 367.02 381.98 332.56 \n\n\nCode\n# Calculate second-phase means\nx_bar &lt;- mean(x_phase2)\ny_bar &lt;- mean(y_phase2)\n\ncat(\"Second-phase mean of Age (x̄):\", round(x_bar, 2), \"years\\n\")\n\n\nSecond-phase mean of Age (x̄): 64.3 years\n\n\nCode\ncat(\"Second-phase mean of Sleep (ȳ):\", round(y_bar, 2), \"hours\\n\\n\")\n\n\nSecond-phase mean of Sleep (ȳ): 389.81 hours\n\n\nCode\n# TWO-PHASE RATIO ESTIMATOR\nR_hat &lt;- y_bar / x_bar\ny_bar_rd &lt;- R_hat * x_bar_prime\n\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"RATIO ESTIMATOR RESULTS\\n\")\n\n\nRATIO ESTIMATOR RESULTS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Sample ratio R̂ = ȳ/x̄:\", round(R_hat, 4), \"\\n\")\n\n\nSample ratio R̂ = ȳ/x̄: 6.0621 \n\n\nCode\ncat(\"Two-phase ratio estimate (ȳ_rd):\", round(y_bar_rd, 4), \"hours\\n\\n\")\n\n\nTwo-phase ratio estimate (ȳ_rd): 400.8643 hours\n\n\nCode\n# VARIANCE CALCULATION\n# Calculate variances and covariance from phase 2\ns_y_sq &lt;- var(y_phase2)\ns_x_sq &lt;- var(x_phase2)\ns_xy &lt;- cov(x_phase2, y_phase2)\n\n# Variance of x from phase 1\ns_x_prime_sq &lt;- var(x_phase1)\n\n# Two-phase ratio variance formula\n# V(ȳ_rd) ≈ (1/n - 1/n')[s²_y + R²s²_x - 2Rs_xy] + R²s²_x'/n'\nterm1 &lt;- (1/n2 - 1/n1) * (s_y_sq + R_hat^2 * s_x_sq - 2 * R_hat * s_xy)\nterm2 &lt;- (R_hat^2 * s_x_prime_sq) / n1\n\nvar_y_rd &lt;- term1 + term2\nse_y_rd &lt;- sqrt(var_y_rd)\n\ncat(\"Variance Components:\\n\")\n\n\nVariance Components:\n\n\nCode\ncat(\"  s²_y (sleep variance, phase 2):\", round(s_y_sq, 4), \"\\n\")\n\n\n  s²_y (sleep variance, phase 2): 1416.857 \n\n\nCode\ncat(\"  s²_x (age variance, phase 2):\", round(s_x_sq, 4), \"\\n\")\n\n\n  s²_x (age variance, phase 2): 42.9079 \n\n\nCode\ncat(\"  s_xy (covariance, phase 2):\", round(s_xy, 4), \"\\n\")\n\n\n  s_xy (covariance, phase 2): -200.502 \n\n\nCode\ncat(\"  s²_x' (age variance, phase 1):\", round(s_x_prime_sq, 4), \"\\n\\n\")\n\n\n  s²_x' (age variance, phase 1): 42.9368 \n\n\nCode\ncat(\"  Term 1 (second-phase component):\", round(term1, 6), \"\\n\")\n\n\n  Term 1 (second-phase component): 271.2316 \n\n\nCode\ncat(\"  Term 2 (first-phase component):\", round(term2, 6), \"\\n\\n\")\n\n\n  Term 2 (first-phase component): 78.89515 \n\n\nCode\ncat(\"Variance of ratio estimator V(ȳ_rd):\", round(var_y_rd, 6), \"\\n\")\n\n\nVariance of ratio estimator V(ȳ_rd): 350.1268 \n\n\nCode\ncat(\"Standard error SE(ȳ_rd):\", round(se_y_rd, 4), \"hours\\n\\n\")\n\n\nStandard error SE(ȳ_rd): 18.7117 hours\n\n\nCode\n# 95% CONFIDENCE INTERVAL\n# Use z-distribution for large samples\nz_critical &lt;- qnorm(0.975)  # 1.96 for 95% CI\n\nci_lower_rd &lt;- y_bar_rd - z_critical * se_y_rd\nci_upper_rd &lt;- y_bar_rd + z_critical * se_y_rd\n\ncat(\"95% CONFIDENCE INTERVAL\\n\")\n\n\n95% CONFIDENCE INTERVAL\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Point estimate:\", round(y_bar_rd, 4), \"hours\\n\")\n\n\nPoint estimate: 400.8643 hours\n\n\nCode\ncat(\"Standard error:\", round(se_y_rd, 4), \"hours\\n\")\n\n\nStandard error: 18.7117 hours\n\n\nCode\ncat(\"Critical value (z_0.025):\", round(z_critical, 4), \"\\n\")\n\n\nCritical value (z_0.025): 1.96 \n\n\nCode\ncat(\"95% CI: [\", round(ci_lower_rd, 4), \",\", round(ci_upper_rd, 4), \"] hours\\n\\n\")\n\n\n95% CI: [ 364.19 , 437.5385 ] hours\n\n\nCode\n# Correlation\nr_xy &lt;- cor(x_phase2, y_phase2)\ncat(\"Correlation between Age and Sleep (r):\", round(r_xy, 4), \"\\n\")\n\n\nCorrelation between Age and Sleep (r): -0.8132 \n\n\nCode\n# Summary\ncat(\"\\n\")\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"SUMMARY\\n\")\n\n\nSUMMARY\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Based on the two-phase ratio estimation:\\n\")\n\n\nBased on the two-phase ratio estimation:\n\n\nCode\ncat(\"  - Estimated average sleeping hours:\", round(y_bar_rd, 2), \"hours\\n\")\n\n\n  - Estimated average sleeping hours: 400.86 hours\n\n\nCode\ncat(\"  - We are 95% confident the true mean is between\\n\")\n\n\n  - We are 95% confident the true mean is between\n\n\nCode\ncat(\"    \", round(ci_lower_rd, 2), \"and\", round(ci_upper_rd, 2), \"hours\\n\")\n\n\n     364.19 and 437.54 hours\n\n\nExplanation:\nTwo-Phase Sampling Design:\nTwo-phase (double) sampling is useful when: - Measuring auxiliary variable \\(x\\) (Age) is cheap - Measuring variable of interest \\(y\\) (Sleep) is expensive - \\(x\\) and \\(y\\) are correlated\nTwo-Phase Ratio Estimator:\n\\[\\bar{y}_{rd} = \\frac{\\bar{y}}{\\bar{x}} \\times \\bar{x}'\\]\nwhere: - \\(\\bar{y}\\) = mean of \\(y\\) from second-phase sample (size \\(n\\)) - \\(\\bar{x}\\) = mean of \\(x\\) from second-phase sample (size \\(n\\)) - \\(\\bar{x}'\\) = mean of \\(x\\) from first-phase sample (size \\(n'\\)) - \\(\\hat{R} = \\bar{y}/\\bar{x}\\) = sample ratio\nVariance Formula:\n\\[V(\\bar{y}_{rd}) \\approx \\left(\\frac{1}{n} - \\frac{1}{n'}\\right)[s_y^2 + \\hat{R}^2 s_x^2 - 2\\hat{R}s_{xy}] + \\frac{\\hat{R}^2 s_{x'}^2}{n'}\\]\nComponents:\n\nFirst term - Variance from ratio estimation in second phase\nSecond term - Variance from estimating \\(\\bar{X}\\) using first phase\n\nAdvantages:\n\nMore cost-effective than measuring \\(y\\) on all \\(n'\\) units\nUses correlation between \\(x\\) and \\(y\\) to improve precision\n\\(\\bar{x}'\\) is more precise than \\(\\bar{x}\\) (larger sample size)\n\nQ.(10) Repeat the above procedure using a regression estimator in two-phase sampling. Deduce the 95% confidence interval.\n\n\nCode\n# Load sleeping hours data (use same data as Q.9)\nsleep_data &lt;- readxl::read_xlsx(\"data/Sleeping Hours.xlsx\")\n\n# Variables\ny &lt;- sleep_data$`Number of hours of sleep`  # Variable of interest (expensive)\nx &lt;- sleep_data$Age                          # Auxiliary variable (cheap)\n\nN &lt;- length(y)  # Population size\nn1 &lt;- 20        # First-phase sample size\nn2 &lt;- 10        # Second-phase sample size\n\ncat(\"TWO-PHASE REGRESSION ESTIMATION\\n\")\n\n\nTWO-PHASE REGRESSION ESTIMATION\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Population size (N):\", N, \"\\n\")\n\n\nPopulation size (N): 50 \n\n\nCode\ncat(\"First-phase sample size (n'):\", n1, \"\\n\")\n\n\nFirst-phase sample size (n'): 20 \n\n\nCode\ncat(\"Second-phase sample size (n):\", n2, \"\\n\\n\")\n\n\nSecond-phase sample size (n): 10 \n\n\nCode\n# PHASE 1: Select 20 units by SRSWOR and measure only Age (x)\nset.seed(789)  # Same seed as Q.9 for comparison\nphase1_indices &lt;- sample(1:N, n1, replace = FALSE)\n\n# First-phase data (only x is measured)\nx_phase1 &lt;- x[phase1_indices]\n\ncat(\"PHASE 1: Measure auxiliary variable (Age) only\\n\")\n\n\nPHASE 1: Measure auxiliary variable (Age) only\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices:\", phase1_indices, \"\\n\\n\")\n\n\nSelected indices: 45 48 12 42 26 35 37 36 3 6 41 29 21 49 2 24 50 30 39 27 \n\n\nCode\n# Calculate first-phase mean of x\nx_bar_prime &lt;- mean(x_phase1)\n\ncat(\"First-phase mean of Age (x̄'):\", round(x_bar_prime, 2), \"years\\n\\n\")\n\n\nFirst-phase mean of Age (x̄'): 66.13 years\n\n\nCode\n# PHASE 2: Select 10 units from phase 1 sample and measure both Age and Sleep\nset.seed(790)  # Same seed as Q.9 for comparison\nphase2_indices_within &lt;- sample(1:n1, n2, replace = FALSE)\nphase2_indices &lt;- phase1_indices[phase2_indices_within]\n\n# Second-phase data (both x and y measured)\nx_phase2 &lt;- x[phase2_indices]\ny_phase2 &lt;- y[phase2_indices]\n\ncat(\"PHASE 2: Measure both Age and Sleeping Hours\\n\")\n\n\nPHASE 2: Measure both Age and Sleeping Hours\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices from phase 1:\", phase2_indices_within, \"\\n\")\n\n\nSelected indices from phase 1: 8 3 9 11 17 19 2 15 6 20 \n\n\nCode\ncat(\"Ages:\", x_phase2, \"\\n\")\n\n\nAges: 71.14 64.94 64.49 64.89 58.66 51.64 60.06 73.82 63.06 70.33 \n\n\nCode\ncat(\"Sleep hours:\", round(y_phase2, 2), \"\\n\\n\")\n\n\nSleep hours: 326.33 401.95 395.99 419.98 412.7 434.5 425.12 367.02 381.98 332.56 \n\n\nCode\n# Calculate second-phase means\nx_bar &lt;- mean(x_phase2)\ny_bar &lt;- mean(y_phase2)\n\ncat(\"Second-phase mean of Age (x̄):\", round(x_bar, 2), \"years\\n\")\n\n\nSecond-phase mean of Age (x̄): 64.3 years\n\n\nCode\ncat(\"Second-phase mean of Sleep (ȳ):\", round(y_bar, 2), \"hours\\n\\n\")\n\n\nSecond-phase mean of Sleep (ȳ): 389.81 hours\n\n\nCode\n# TWO-PHASE REGRESSION ESTIMATOR\n# Fit regression model using phase 2 data\nmodel &lt;- lm(y_phase2 ~ x_phase2)\nbeta_hat &lt;- coef(model)[2]  # Regression slope\nalpha_hat &lt;- coef(model)[1] # Intercept\n\n# Regression estimator\ny_bar_ld &lt;- y_bar + beta_hat * (x_bar_prime - x_bar)\n\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"REGRESSION ESTIMATOR RESULTS\\n\")\n\n\nREGRESSION ESTIMATOR RESULTS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Regression model: Sleep = α + β × Age\\n\")\n\n\nRegression model: Sleep = α + β × Age\n\n\nCode\ncat(\"  Intercept (α̂):\", round(alpha_hat, 4), \"\\n\")\n\n\n  Intercept (α̂): 690.291 \n\n\nCode\ncat(\"  Slope (β̂):\", round(beta_hat, 4), \"\\n\")\n\n\n  Slope (β̂): -4.6728 \n\n\nCode\ncat(\"  Adjustment (x̄' - x̄):\", round(x_bar_prime - x_bar, 4), \"\\n\\n\")\n\n\n  Adjustment (x̄' - x̄): 1.823 \n\n\nCode\ncat(\"Two-phase regression estimate (ȳ_ld):\", round(y_bar_ld, 4), \"hours\\n\\n\")\n\n\nTwo-phase regression estimate (ȳ_ld): 381.2944 hours\n\n\nCode\n# VARIANCE CALCULATION\n# Method 1: Using correlation\ns_y_sq &lt;- var(y_phase2)\ns_x_sq &lt;- var(x_phase2)\nr_xy &lt;- cor(x_phase2, y_phase2)\n\n# Variance of x from phase 1\ns_x_prime_sq &lt;- var(x_phase1)\n\n# Two-phase regression variance formula\n# V(ȳ_ld) ≈ (1/n - 1/n')s²_y(1 - r²) + s²_x'/n'\nvar_y_ld_method1 &lt;- (1/n2 - 1/n1) * s_y_sq * (1 - r_xy^2) + s_x_prime_sq / n1\n\n# Method 2: Using MSE from regression\nresiduals &lt;- resid(model)\nMSE &lt;- sum(residuals^2) / (n2 - 2)\nvar_y_ld_method2 &lt;- (1/n2 - 1/n1) * MSE + s_x_prime_sq / n1\n\n# Use Method 1 for standard error\nse_y_ld &lt;- sqrt(var_y_ld_method1)\n\ncat(\"Variance Components:\\n\")\n\n\nVariance Components:\n\n\nCode\ncat(\"  s²_y (sleep variance, phase 2):\", round(s_y_sq, 4), \"\\n\")\n\n\n  s²_y (sleep variance, phase 2): 1416.857 \n\n\nCode\ncat(\"  s²_x (age variance, phase 2):\", round(s_x_sq, 4), \"\\n\")\n\n\n  s²_x (age variance, phase 2): 42.9079 \n\n\nCode\ncat(\"  s²_x' (age variance, phase 1):\", round(s_x_prime_sq, 4), \"\\n\")\n\n\n  s²_x' (age variance, phase 1): 42.9368 \n\n\nCode\ncat(\"  Correlation r_xy:\", round(r_xy, 4), \"\\n\")\n\n\n  Correlation r_xy: -0.8132 \n\n\nCode\ncat(\"  R² (variance explained):\", round(r_xy^2, 4), \"\\n\")\n\n\n  R² (variance explained): 0.6613 \n\n\nCode\ncat(\"  MSE (residual variance):\", round(MSE, 4), \"\\n\\n\")\n\n\n  MSE (residual variance): 539.9347 \n\n\nCode\ncat(\"Variance Calculation:\\n\")\n\n\nVariance Calculation:\n\n\nCode\ncat(\"  Method 1 (using r²):\", round(var_y_ld_method1, 6), \"\\n\")\n\n\n  Method 1 (using r²): 26.14394 \n\n\nCode\ncat(\"  Method 2 (using MSE):\", round(var_y_ld_method2, 6), \"\\n\\n\")\n\n\n  Method 2 (using MSE): 29.14358 \n\n\nCode\ncat(\"Variance of regression estimator V(ȳ_ld):\", round(var_y_ld_method1, 6), \"\\n\")\n\n\nVariance of regression estimator V(ȳ_ld): 26.14394 \n\n\nCode\ncat(\"Standard error SE(ȳ_ld):\", round(se_y_ld, 4), \"hours\\n\\n\")\n\n\nStandard error SE(ȳ_ld): 5.1131 hours\n\n\nCode\n# 95% CONFIDENCE INTERVAL\n# Use z-distribution for large samples\nz_critical &lt;- qnorm(0.975)  # 1.96 for 95% CI\n\nci_lower_ld &lt;- y_bar_ld - z_critical * se_y_ld\nci_upper_ld &lt;- y_bar_ld + z_critical * se_y_ld\n\ncat(\"95% CONFIDENCE INTERVAL\\n\")\n\n\n95% CONFIDENCE INTERVAL\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Point estimate:\", round(y_bar_ld, 4), \"hours\\n\")\n\n\nPoint estimate: 381.2944 hours\n\n\nCode\ncat(\"Standard error:\", round(se_y_ld, 4), \"hours\\n\")\n\n\nStandard error: 5.1131 hours\n\n\nCode\ncat(\"Critical value (z_0.025):\", round(z_critical, 4), \"\\n\")\n\n\nCritical value (z_0.025): 1.96 \n\n\nCode\ncat(\"95% CI: [\", round(ci_lower_ld, 4), \",\", round(ci_upper_ld, 4), \"] hours\\n\\n\")\n\n\n95% CI: [ 371.2729 , 391.3159 ] hours\n\n\nCode\n# COMPARISON WITH RATIO ESTIMATOR (from Q.9)\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"COMPARISON: RATIO vs REGRESSION ESTIMATORS\\n\")\n\n\nCOMPARISON: RATIO vs REGRESSION ESTIMATORS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\n# Recalculate ratio estimator for comparison\nR_hat &lt;- y_bar / x_bar\ny_bar_rd &lt;- R_hat * x_bar_prime\ns_xy &lt;- cov(x_phase2, y_phase2)\nvar_y_rd &lt;- (1/n2 - 1/n1) * (s_y_sq + R_hat^2 * s_x_sq - 2 * R_hat * s_xy) + \n            (R_hat^2 * s_x_prime_sq) / n1\nse_y_rd &lt;- sqrt(var_y_rd)\n\ncomparison_table &lt;- data.frame(\n  Estimator = c(\"Ratio\", \"Regression\"),\n  Estimate = c(round(y_bar_rd, 4), round(y_bar_ld, 4)),\n  Variance = c(round(var_y_rd, 6), round(var_y_ld_method1, 6)),\n  SE = c(round(se_y_rd, 4), round(se_y_ld, 4)),\n  CI_Lower = c(round(y_bar_rd - z_critical * se_y_rd, 4),\n               round(ci_lower_ld, 4)),\n  CI_Upper = c(round(y_bar_rd + z_critical * se_y_rd, 4),\n               round(ci_upper_ld, 4))\n)\n\nprint(comparison_table)\n\n\n          Estimator Estimate  Variance      SE CI_Lower CI_Upper\n              Ratio 400.8643 350.12679 18.7117 364.1900 437.5385\nx_phase2 Regression 381.2944  26.14394  5.1131 371.2729 391.3159\n\n\nCode\ncat(\"\\nRelative Efficiency (Ratio vs Regression):\", \n    round(var_y_rd / var_y_ld_method1, 4), \"\\n\")\n\n\n\nRelative Efficiency (Ratio vs Regression): 13.3923 \n\n\nCode\n# Summary\ncat(\"\\n\")\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"SUMMARY\\n\")\n\n\nSUMMARY\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Based on the two-phase regression estimation:\\n\")\n\n\nBased on the two-phase regression estimation:\n\n\nCode\ncat(\"  - Estimated average sleeping hours:\", round(y_bar_ld, 2), \"hours\\n\")\n\n\n  - Estimated average sleeping hours: 381.29 hours\n\n\nCode\ncat(\"  - We are 95% confident the true mean is between\\n\")\n\n\n  - We are 95% confident the true mean is between\n\n\nCode\ncat(\"    \", round(ci_lower_ld, 2), \"and\", round(ci_upper_ld, 2), \"hours\\n\\n\")\n\n\n     371.27 and 391.32 hours\n\n\nCode\ncat(\"The regression estimator is generally more efficient than the ratio\\n\")\n\n\nThe regression estimator is generally more efficient than the ratio\n\n\nCode\ncat(\"estimator because it does not assume the relationship passes through\\n\")\n\n\nestimator because it does not assume the relationship passes through\n\n\nCode\ncat(\"the origin (it includes an intercept term).\\n\")\n\n\nthe origin (it includes an intercept term).\n\n\nExplanation:\nTwo-Phase Regression Estimator:\n\\[\\bar{y}_{ld} = \\bar{y} + \\hat{\\beta}(\\bar{x}' - \\bar{x})\\]\nwhere: - \\(\\bar{y}\\) = mean of \\(y\\) from second-phase sample (size \\(n\\)) - \\(\\bar{x}\\) = mean of \\(x\\) from second-phase sample (size \\(n\\)) - \\(\\bar{x}'\\) = mean of \\(x\\) from first-phase sample (size \\(n'\\)) - \\(\\hat{\\beta} = \\frac{s_{xy}}{s_x^2}\\) = regression coefficient from phase 2\nVariance Formula:\nMethod 1 (using correlation): \\[V(\\bar{y}_{ld}) \\approx \\left(\\frac{1}{n} - \\frac{1}{n'}\\right)s_y^2(1-r_{xy}^2) + \\frac{s_{x'}^2}{n'}\\]\nMethod 2 (using MSE): \\[V(\\bar{y}_{ld}) \\approx \\left(\\frac{1}{n} - \\frac{1}{n'}\\right)MSE + \\frac{s_{x'}^2}{n'}\\]\nwhere \\(MSE = \\frac{1}{n-2}\\sum(y_i - \\hat{y}_i)^2\\)\nKey Differences: Ratio vs Regression\n\n\n\n\n\n\n\n\nFeature\nRatio Estimator\nRegression Estimator\n\n\n\n\nModel\n\\(y = Rx\\) (through origin)\n\\(y = \\alpha + \\beta x\\) (with intercept)\n\n\nEfficiency\nGood if relationship is proportional\nGenerally more efficient\n\n\nBias\nSlightly biased\nApproximately unbiased\n\n\nVariance\nDepends on \\(R^2\\)\nReduced by factor \\((1-r^2)\\)\n\n\n\nAdvantages of Regression:\n\nAccounts for intercept (more flexible)\nGenerally lower variance\nBetter when relationship doesn’t pass through origin\nVariance reduction proportional to \\(r^2\\) (squared correlation)\n\nQ.(11) Select a first-phase sample of 20 units by SRSWOR from excel sheet Income and expenditure and note only the income of tribals in Western Ghats of Maharashtra. From the selected first-phase sample, select a subsample of 10 units and note income and expenditure. Estimate the average expenditure using ratio and regression estimators. Deduce their 95% confidence intervals.\n\n\nCode\n# Load income and expenditure data\nincome_exp_data &lt;- readxl::read_xlsx(\"data/Income and expenditure.xlsx\")\n\n# Display data structure\ncat(\"Data structure:\\n\")\n\n\nData structure:\n\n\nCode\nprint(head(income_exp_data))\n\n\n# A tibble: 6 × 3\n  `Sr. No.` Income Expenditure\n      &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;\n1         1  24000        4700\n2         2  25000        4000\n3         3  31000        8500\n4         4  21000        5000\n5         5  27000        7000\n6         6  35000        5500\n\n\nCode\ncat(\"\\n\")\n\n\nCode\n# Variables\nx &lt;- income_exp_data$Income        # Auxiliary variable (cheap to measure)\ny &lt;- income_exp_data$Expenditure   # Variable of interest (expensive to measure)\n\nN &lt;- length(y)  # Population size\nn1 &lt;- 20        # First-phase sample size\nn2 &lt;- 10        # Second-phase sample size\n\ncat(\"TWO-PHASE SAMPLING: INCOME AND EXPENDITURE\\n\")\n\n\nTWO-PHASE SAMPLING: INCOME AND EXPENDITURE\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"Population size (N):\", N, \"\\n\")\n\n\nPopulation size (N): 40 \n\n\nCode\ncat(\"First-phase sample size (n'):\", n1, \"\\n\")\n\n\nFirst-phase sample size (n'): 20 \n\n\nCode\ncat(\"Second-phase sample size (n):\", n2, \"\\n\\n\")\n\n\nSecond-phase sample size (n): 10 \n\n\nCode\n# PHASE 1: Select 20 units by SRSWOR and measure only Income\nset.seed(456)\nphase1_indices &lt;- sample(1:N, n1, replace = FALSE)\nx_phase1 &lt;- x[phase1_indices]\n\ncat(\"PHASE 1: Measure Income only\\n\")\n\n\nPHASE 1: Measure Income only\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices:\", phase1_indices, \"\\n\\n\")\n\n\nSelected indices: 37 35 38 21 27 25 14 31 26 9 15 32 19 11 23 8 34 13 5 20 \n\n\nCode\nx_bar_prime &lt;- mean(x_phase1)\ns_x_prime_sq &lt;- var(x_phase1)\n\ncat(\"First-phase mean of Income (x̄'):\", round(x_bar_prime, 2), \"₹\\n\\n\")\n\n\nFirst-phase mean of Income (x̄'): 49840 ₹\n\n\nCode\n# PHASE 2: Select 10 units from phase 1 and measure both\nset.seed(457)\nphase2_indices_within &lt;- sample(1:n1, n2, replace = FALSE)\nphase2_indices &lt;- phase1_indices[phase2_indices_within]\n\nx_phase2 &lt;- x[phase2_indices]\ny_phase2 &lt;- y[phase2_indices]\n\ncat(\"PHASE 2: Measure both Income and Expenditure\\n\")\n\n\nPHASE 2: Measure both Income and Expenditure\n\n\nCode\ncat(strrep(\"-\", 70), \"\\n\")\n\n\n---------------------------------------------------------------------- \n\n\nCode\ncat(\"Selected indices from phase 1:\", phase2_indices_within, \"\\n\\n\")\n\n\nSelected indices from phase 1: 8 13 12 3 16 10 4 14 19 15 \n\n\nCode\nx_bar &lt;- mean(x_phase2)\ny_bar &lt;- mean(y_phase2)\ns_y_sq &lt;- var(y_phase2)\ns_x_sq &lt;- var(x_phase2)\ns_xy &lt;- cov(x_phase2, y_phase2)\nr_xy &lt;- cor(x_phase2, y_phase2)\n\ncat(\"Second-phase mean of Income (x̄):\", round(x_bar, 2), \"₹\\n\")\n\n\nSecond-phase mean of Income (x̄): 66640 ₹\n\n\nCode\ncat(\"Second-phase mean of Expenditure (ȳ):\", round(y_bar, 2), \"₹\\n\")\n\n\nSecond-phase mean of Expenditure (ȳ): 21160 ₹\n\n\nCode\ncat(\"Correlation (r_xy):\", round(r_xy, 4), \"\\n\\n\")\n\n\nCorrelation (r_xy): 0.1616 \n\n\nCode\n# RATIO ESTIMATOR\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"RATIO ESTIMATOR\\n\")\n\n\nRATIO ESTIMATOR\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\nR_hat &lt;- y_bar / x_bar\ny_bar_rd &lt;- R_hat * x_bar_prime\n\ncat(\"Sample ratio R̂:\", round(R_hat, 4), \"\\n\")\n\n\nSample ratio R̂: 0.3175 \n\n\nCode\ncat(\"Ratio estimate (ȳ_rd):\", round(y_bar_rd, 2), \"₹\\n\\n\")\n\n\nRatio estimate (ȳ_rd): 15825.55 ₹\n\n\nCode\nterm1_ratio &lt;- (1/n2 - 1/n1) * (s_y_sq + R_hat^2 * s_x_sq - 2 * R_hat * s_xy)\nterm2_ratio &lt;- (R_hat^2 * s_x_prime_sq) / n1\nvar_y_rd &lt;- term1_ratio + term2_ratio\nse_y_rd &lt;- sqrt(var_y_rd)\n\ncat(\"Variance V(ȳ_rd):\", round(var_y_rd, 4), \"\\n\")\n\n\nVariance V(ȳ_rd): 111890518 \n\n\nCode\ncat(\"Standard error:\", round(se_y_rd, 2), \"₹\\n\\n\")\n\n\nStandard error: 10577.83 ₹\n\n\nCode\nz_crit &lt;- qnorm(0.975)\nci_lower_rd &lt;- y_bar_rd - z_crit * se_y_rd\nci_upper_rd &lt;- y_bar_rd + z_crit * se_y_rd\n\ncat(\"95% CI (Ratio): [\", round(ci_lower_rd, 2), \",\", \n    round(ci_upper_rd, 2), \"] ₹\\n\\n\")\n\n\n95% CI (Ratio): [ -4906.62 , 36557.71 ] ₹\n\n\nCode\n# REGRESSION ESTIMATOR\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"REGRESSION ESTIMATOR\\n\")\n\n\nREGRESSION ESTIMATOR\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\nmodel &lt;- lm(y_phase2 ~ x_phase2)\nbeta_hat &lt;- coef(model)[2]\nalpha_hat &lt;- coef(model)[1]\n\ny_bar_ld &lt;- y_bar + beta_hat * (x_bar_prime - x_bar)\n\ncat(\"Regression slope (β̂):\", round(beta_hat, 4), \"\\n\")\n\n\nRegression slope (β̂): 0.0389 \n\n\nCode\ncat(\"Regression estimate (ȳ_ld):\", round(y_bar_ld, 2), \"₹\\n\\n\")\n\n\nRegression estimate (ȳ_ld): 20505.79 ₹\n\n\nCode\nvar_y_ld &lt;- (1/n2 - 1/n1) * s_y_sq * (1 - r_xy^2) + s_x_prime_sq / n1\nse_y_ld &lt;- sqrt(var_y_ld)\n\ncat(\"Variance V(ȳ_ld):\", round(var_y_ld, 4), \"\\n\")\n\n\nVariance V(ȳ_ld): 350900531 \n\n\nCode\ncat(\"Standard error:\", round(se_y_ld, 2), \"₹\\n\\n\")\n\n\nStandard error: 18732.34 ₹\n\n\nCode\nci_lower_ld &lt;- y_bar_ld - z_crit * se_y_ld\nci_upper_ld &lt;- y_bar_ld + z_crit * se_y_ld\n\ncat(\"95% CI (Regression): [\", round(ci_lower_ld, 2), \",\", \n    round(ci_upper_ld, 2), \"] ₹\\n\\n\")\n\n\n95% CI (Regression): [ -16208.92 , 57220.5 ] ₹\n\n\nCode\n# COMPARISON\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncat(\"COMPARISON OF ESTIMATORS\\n\")\n\n\nCOMPARISON OF ESTIMATORS\n\n\nCode\ncat(strrep(\"=\", 70), \"\\n\")\n\n\n====================================================================== \n\n\nCode\ncomparison_table &lt;- data.frame(\n  Estimator = c(\"Ratio\", \"Regression\"),\n  Estimate = c(round(y_bar_rd, 2), round(y_bar_ld, 2)),\n  Variance = c(round(var_y_rd, 4), round(var_y_ld, 4)),\n  SE = c(round(se_y_rd, 2), round(se_y_ld, 2)),\n  CI_Lower = c(round(ci_lower_rd, 2), round(ci_lower_ld, 2)),\n  CI_Upper = c(round(ci_upper_rd, 2), round(ci_upper_ld, 2))\n)\n\nprint(comparison_table)\n\n\n          Estimator Estimate  Variance       SE  CI_Lower CI_Upper\n              Ratio 15825.55 111890518 10577.83  -4906.62 36557.71\nx_phase2 Regression 20505.79 350900531 18732.34 -16208.92 57220.50\n\n\nCode\ncat(\"\\nRelative Efficiency:\", round(var_y_rd / var_y_ld, 4), \"\\n\")\n\n\n\nRelative Efficiency: 0.3189 \n\n\nCode\ncat(\"The\", ifelse(var_y_ld &lt; var_y_rd, \"regression\", \"ratio\"), \n    \"estimator is more efficient.\\n\")\n\n\nThe ratio estimator is more efficient.\n\n\nExplanation:\nTwo-Phase Design for Income and Expenditure:\n\nPhase 1 (n’ = 20): Measure Income only (cheap survey)\nPhase 2 (n = 10): Measure both Income and Expenditure (expensive detailed survey)\n\nEstimators:\nRatio: \\(\\bar{y}_{rd} = \\hat{R} \\times \\bar{x}' = \\frac{\\bar{y}}{\\bar{x}} \\times \\bar{x}'\\)\nRegression: \\(\\bar{y}_{ld} = \\bar{y} + \\hat{\\beta}(\\bar{x}' - \\bar{x})\\)\nPractical Application:\nThis design is common in socio-economic surveys where: - Income data is easier to collect (records, simplified questions) - Expenditure data requires detailed tracking and recall - Strong correlation between income and expenditure improves efficiency"
  }
]